<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Online Bus Booking</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-inner container">
            <div class="brand">üöå TripWheels</div>
            <ul class="nav-links">
                <li><a href="{{ url_for('index') }}" class="active">üè† Home</a></li>
                <li><a href="{{ url_for('view_bookings') }}">üé´ Bookings</a></li>
                <li><a href="{{ url_for('help_page') }}">‚ùì Help</a></li>
                {% if session.get('role') == 'admin' %}
                <li><a href="{{ url_for('admin_buses') }}">Admin</a></li>
                {% endif %}
                {% if session.get('user_email') %}
                <li><a href="{{ url_for('account_page') }}">üë§ My Account</a></li>
                <li><a href="{{ url_for('logout') }}">üö™ Logout</a></li>
                {% else %}
                <li><a href="{{ url_for('login') }}">Login</a></li>
                <li><a href="{{ url_for('register') }}">Register</a></li>
                {% endif %}
            </ul>
        </div>
    </nav>
    {% with msgs = get_flashed_messages(with_categories=True) %}
      {% if msgs %}
      <div class="container" style="max-width:720px">
        {% for cat, msg in msgs %}
          <div class="toast {{ 'error' if cat=='error' else 'show' }}" style="position:static">{{ msg }}</div>
        {% endfor %}
      </div>
      {% endif %}
    {% endwith %}
    <div class="container">
        <section class="hero">
            <div class="hero-inner">
                <h1>Travel made easy ‚Äì Book bus tickets fast</h1>
                <p class="muted">Enter From, To, and Date. Pick seats and book. Simple and quick.</p>
            </div>
        </section>
        <section class="search card" id="searchCard" style="padding:16px">
            <h2 style="margin:0 0 8px 6px">Search</h2>
            <div class="offer-banner" style="margin:8px 6px 12px; padding:10px 12px; border:1px dashed #A78BFA; border-radius:10px; background:rgba(167,139,250,0.08); color:#eae8ff; display:flex; align-items:center; gap:10px">
                <span style="font-weight:700; color:#F5D0FE">Offer</span>
                <span>Use code <strong>TRIP100</strong> to get ‚Çπ100 off on your booking</span>
            </div>
            <div class="form-row">
                <div class="autocomplete">
                    <input id="fromCity" placeholder="From" autocomplete="off" />
                    <div id="fromSuggest" class="suggestions" role="listbox" aria-label="From suggestions"></div>
                </div>
                <div class="autocomplete">
                    <input id="toCity" placeholder="To" autocomplete="off" />
                    <div id="toSuggest" class="suggestions" role="listbox" aria-label="To suggestions"></div>
                </div>
                <input id="travelDate" type="date" />
                <button id="searchBtn" type="button">Search</button>
            </div>
            <div class="form-row secondary">
                <label class="inline">Sort by
                    <select id="sortBy">
                        <option value="recommended">Recommended</option>
                        <option value="rating_desc">Ratings: High to Low</option>
                        <option value="fare_asc">Fare: Low to High</option>
                        <option value="fare_desc">Fare: High to Low</option>
                        <option value="depart_asc">Departure: Early to Late</option>
                        <option value="depart_desc">Departure: Late to Early</option>
                    </select>
                </label>
                <label class="inline">Operator
                    <input id="operator" placeholder="e.g. APSRTC, Orange" />
                </label>
                <label class="inline">Type
                    <select id="busType">
                        <option value="">Any</option>
                        <option value="ac">AC</option>
                        <option value="nonac">Non-AC</option>
                        <option value="sleeper">Sleeper</option>
                        <option value="seater">Seater</option>
                        <option value="luxury">Luxury</option>
                    </select>
                </label>
                <label class="inline">Min Fare
                    <input id="fareMin" type="number" inputmode="numeric" placeholder="0" />
                </label>
                <label class="inline">Max Fare
                    <input id="fareMax" type="number" inputmode="numeric" placeholder="2000" />
                </label>
            </div>
        </section>
        <section class="results">
            <h2 style="margin-left:6px">Available Trips</h2>
            <div id="bus-list" class="grid"></div>
            <div id="no-results" class="muted" style="display:none">No trips found. Try different filters.</div>
        </section>
    </div>



    <div id="bookingModal" class="modal" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Complete your booking</h3>
                <button id="closeModal" type="button" class="icon-btn" aria-label="Close">‚úñ</button>
            </div>
            <div class="modal-body">
                <div id="selectedTrip" class="muted"></div>
                <div class="seat-section">
                    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
                        <h4 style="margin:6px 0">Select Seats</h4>
                        <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
                            <div class="muted">Total: ‚Çπ<span id="fareTotal">0</span></div>
                            <input id="couponCode" placeholder="Coupon (e.g. TRIP100)" style="padding:6px;border-radius:8px;border:none" />
                            <button id="applyCoupon" type="button" class="btn-outline">Apply</button>
                            <button id="seatSelectDone" type="button" class="btn-outline">Select</button>
                        </div>
                    </div>
                    <div id="seatMap" class="seat-map"></div>
                    <div class="muted" style="font-size:12px;margin-top:6px">Legend: <span class="seat s-legend available"></span> Available <span class="seat s-legend selected"></span> Selected <span class="seat s-legend booked"></span> Booked</div>
                    <div id="discountNote" class="muted" style="font-size:12px;display:none;margin-top:4px"></div>
                </div>
                <div class="form-col" style="margin-top:10px">
                    <label>Boarding Point
                        <select id="boardingPoint">
                            <option value="Main Bus Stand">Main Bus Stand</option>
                            <option value="City Center">City Center</option>
                            <option value="Bypass">Bypass</option>
                        </select>
                    </label>
                    <label>Dropping Point
                        <select id="droppingPoint">
                            <option value="Central Station">Central Station</option>
                            <option value="City Center">City Center</option>
                            <option value="Outer Ring">Outer Ring</option>
                        </select>
                    </label>
                </div>
                
                <div class="form-col" style="margin-top:10px">
                    <h4 style="margin:6px 0">Passenger Details</h4>
                    <div id="passengersList" class="passenger-list" style="display:grid;gap:10px"></div>
                    <div class="muted" style="font-size:12px">Please enter each passenger's Name, Email, Age, and Gender.</div>
                </div>
                <button id="confirmBooking" type="button">Confirm Booking</button>
            </div>
        </div>
    </div>

    <div id="toasts" class="toast-container" aria-live="polite" aria-atomic="true"></div>

    <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>
